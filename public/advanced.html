<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Analytics - TeamPulse Mindguard AI</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            line-height: 1.6;
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.6), rgba(30, 41, 59, 0.3));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #fff 0%, #a5b4fc 50%, #c4b5fd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .analytics-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.6), rgba(30, 41, 59, 0.3));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 2rem;
        }

        .card-title {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .score-display {
            display: flex;
            align-items: baseline;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .score-value {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-label {
            color: #94a3b8;
            font-size: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            border-radius: 4px;
            transition: width 1s ease;
        }

        .benchmark-item {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            margin-bottom: 0.75rem;
        }

        .benchmark-label {
            color: #cbd5e1;
        }

        .benchmark-value {
            font-weight: 600;
            color: #fff;
        }

        .forecast-item {
            padding: 1.5rem;
            background: rgba(15, 23, 42, 0.5);
            border-left: 4px solid;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .forecast-item.positive {
            border-color: #22c55e;
        }

        .forecast-item.neutral {
            border-color: #fbbf24;
        }

        .forecast-item.negative {
            border-color: #ef4444;
        }

        .forecast-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .forecast-description {
            color: #94a3b8;
            font-size: 0.95rem;
        }

        .recommendation-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .recommendation-icon {
            font-size: 2rem;
        }

        .recommendation-title {
            font-weight: 600;
            color: #fff;
            font-size: 1.1rem;
        }

        .recommendation-content {
            color: #cbd5e1;
            line-height: 1.7;
        }

        .copy-btn {
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 6px;
            color: #a5b4fc;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: rgba(99, 102, 241, 0.3);
        }

        .roi-breakdown {
            display: grid;
            gap: 1rem;
        }

        .roi-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
        }

        .roi-item-label {
            color: #cbd5e1;
        }

        .roi-item-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #22c55e;
        }

        @media (max-width: 768px) {
            .analytics-grid {
                grid-template-columns: 1fr;
            }

            body {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="header-title">üìä Advanced Analytics - TeamPulse Mindguard AI</h1>
            <a href="dashboard.html" class="nav-btn">‚Üê –ù–∞–∑–∞–¥ –¥–æ Dashboard</a>
        </header>

        <div class="analytics-grid">
            <!-- Team Health Score -->
            <div class="analytics-card">
                <h2 class="card-title">üè• –ó–∞–≥–∞–ª—å–Ω–∏–π –Ü–Ω–¥–µ–∫—Å –ó–¥–æ—Ä–æ–≤'—è –ö–æ–º–∞–Ω–¥–∏</h2>
                <div class="score-display">
                    <div class="score-value" id="healthScore">0</div>
                    <div class="score-label">/ 100</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="healthProgress" style="width: 0%"></div>
                </div>
                <p style="color: #94a3b8; margin-top: 1rem;">
                    –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ WHO-5, PHQ-9, GAD-7, MBI —Ç–∞ —ñ–Ω—à–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤
                </p>
            </div>

            <!-- Industry Benchmarks -->
            <div class="analytics-card">
                <h2 class="card-title">üìä –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –ì–∞–ª—É–∑–µ–≤–∏–º–∏ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏</h2>
                <div class="benchmark-item">
                    <span class="benchmark-label">–ë–ª–∞–≥–æ–ø–æ–ª—É—á—á—è (WHO-5)</span>
                    <span class="benchmark-value" id="who5Benchmark">-</span>
                </div>
                <div class="benchmark-item">
                    <span class="benchmark-label">–î–µ–ø—Ä–µ—Å—ñ—è (PHQ-9)</span>
                    <span class="benchmark-value" id="phq9Benchmark">-</span>
                </div>
                <div class="benchmark-item">
                    <span class="benchmark-label">–¢—Ä–∏–≤–æ–∂–Ω—ñ—Å—Ç—å (GAD-7)</span>
                    <span class="benchmark-value" id="gad7Benchmark">-</span>
                </div>
                <div class="benchmark-item">
                    <span class="benchmark-label">–í–∏–≥–æ—Ä–∞–Ω–Ω—è (MBI)</span>
                    <span class="benchmark-value" id="mbiBenchmark">-</span>
                </div>
            </div>

            <!-- Monthly Forecast -->
            <div class="analytics-card">
                <h2 class="card-title">üîÆ –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –ù–∞—Å—Ç—É–ø–Ω–∏–π –ú—ñ—Å—è—Ü—å</h2>
                <div id="forecastItems">
                    <!-- Populated by JavaScript -->
                </div>
            </div>

            <!-- Sleep Debt Analysis -->
            <div class="analytics-card">
                <h2 class="card-title">üò¥ –ê–Ω–∞–ª—ñ–∑ –î–µ—Ñ—ñ—Ü–∏—Ç—É –°–Ω—É</h2>
                <div class="score-display">
                    <div class="score-value" id="sleepDebt">0</div>
                    <div class="score-label">–≥–æ–¥–∏–Ω/—Ç–∏–∂–¥–µ–Ω—å</div>
                </div>
                <p style="color: #94a3b8; margin-top: 1rem;">
                    –°–µ—Ä–µ–¥–Ω—ñ–π –¥–µ—Ñ—ñ—Ü–∏—Ç —Å–Ω—É –Ω–∞ –∫–æ–º–∞–Ω–¥—É. –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ –Ω–æ—Ä–º–∞: 7-9 –≥–æ–¥–∏–Ω –Ω–∞ –¥–æ–±—É.
                </p>
                <canvas id="sleepChart" style="margin-top: 1.5rem;"></canvas>
            </div>

            <!-- Wellness ROI -->
            <div class="analytics-card">
                <h2 class="card-title">üí∞ ROI –ü—Ä–æ–≥—Ä–∞–º –ë–ª–∞–≥–æ–ø–æ–ª—É—á—á—è</h2>
                <div class="roi-breakdown">
                    <div class="roi-item">
                        <span class="roi-item-label">–ó–Ω–∏–∂–µ–Ω–Ω—è –ø–ª–∏–Ω–Ω–æ—Å—Ç—ñ –∫–∞–¥—Ä—ñ–≤</span>
                        <span class="roi-item-value">+120%</span>
                    </div>
                    <div class="roi-item">
                        <span class="roi-item-label">–ó–º–µ–Ω—à–µ–Ω–Ω—è –ª—ñ–∫–∞—Ä–Ω—è–Ω–∏—Ö</span>
                        <span class="roi-item-value">+85%</span>
                    </div>
                    <div class="roi-item">
                        <span class="roi-item-label">–ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ</span>
                        <span class="roi-item-value">+135%</span>
                    </div>
                    <div class="roi-item" style="border-top: 2px solid rgba(99, 102, 241, 0.3); margin-top: 0.5rem; padding-top: 1rem;">
                        <span class="roi-item-label"><strong>–ó–∞–≥–∞–ª—å–Ω–∏–π ROI</strong></span>
                        <span class="roi-item-value" style="font-size: 2rem;">+340%</span>
                    </div>
                </div>
            </div>

            <!-- Stress Distribution -->
            <div class="analytics-card">
                <h2 class="card-title">üìà –†–æ–∑–ø–æ–¥—ñ–ª –†—ñ–≤–Ω—ñ–≤ –°—Ç—Ä–µ—Å—É</h2>
                <canvas id="stressChart"></canvas>
            </div>
        </div>

        <!-- Personalized Recommendations -->
        <div class="analytics-card" style="margin-bottom: 2rem;">
            <h2 class="card-title">üí° –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</h2>
            <div id="recommendations">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Sample data (in real app, this would come from API)
        const teamData = {
            employees: [
                {
                    name: '–û–ª–µ–∫—Å—ñ–π –ö–æ–≤–∞–ª–µ–Ω–∫–æ',
                    metrics: { who5: 68, phq9: 8, gad7: 7, mbi: 28, sleepDuration: 7.2, sleepQuality: 7, workLifeBalance: 6, stressLevel: 6 }
                },
                {
                    name: '–ú–∞—Ä—ñ—è –®–µ–≤—á–µ–Ω–∫–æ',
                    metrics: { who5: 72, phq9: 6, gad7: 5, mbi: 24, sleepDuration: 7.5, sleepQuality: 8, workLifeBalance: 7, stressLevel: 5 }
                },
                {
                    name: '–î–º–∏—Ç—Ä–æ –ü–µ—Ç—Ä–µ–Ω–∫–æ',
                    metrics: { who5: 45, phq9: 14, gad7: 12, mbi: 42, sleepDuration: 5.8, sleepQuality: 4, workLifeBalance: 4, stressLevel: 8 }
                },
                {
                    name: '–û–ª–µ–Ω–∞ –Ü–≤–∞–Ω–µ–Ω–∫–æ',
                    metrics: { who5: 78, phq9: 4, gad7: 3, mbi: 18, sleepDuration: 8.0, sleepQuality: 9, workLifeBalance: 8, stressLevel: 3 }
                },
                {
                    name: '–ê–Ω–¥—Ä—ñ–π –ú–µ–ª—å–Ω–∏–∫',
                    metrics: { who5: 52, phq9: 11, gad7: 10, mbi: 38, sleepDuration: 6.2, sleepQuality: 5, workLifeBalance: 5, stressLevel: 7 }
                },
                {
                    name: '–¢–µ—Ç—è–Ω–∞ –ë–æ–Ω–¥–∞—Ä–µ–Ω–∫–æ',
                    metrics: { who5: 64, phq9: 7, gad7: 6, mbi: 26, sleepDuration: 7.0, sleepQuality: 7, workLifeBalance: 6, stressLevel: 6 }
                },
                {
                    name: '–Ü–≥–æ—Ä –¢–∫–∞—á–µ–Ω–∫–æ',
                    metrics: { who5: 70, phq9: 5, gad7: 4, mbi: 22, sleepDuration: 7.3, sleepQuality: 8, workLifeBalance: 7, stressLevel: 5 }
                },
                {
                    name: '–ù–∞—Ç–∞–ª—ñ—è –°–∞–≤—á–µ–Ω–∫–æ',
                    metrics: { who5: 58, phq9: 9, gad7: 8, mbi: 32, sleepDuration: 6.5, sleepQuality: 6, workLifeBalance: 5, stressLevel: 7 }
                }
            ]
        };

        // Calculate team health score
        function calculateHealthScore() {
            const employees = teamData.employees;
            let totalScore = 0;

            employees.forEach(emp => {
                const who5Score = emp.metrics.who5;
                const phq9Score = Math.max(0, 100 - (emp.metrics.phq9 / 27 * 100));
                const gad7Score = Math.max(0, 100 - (emp.metrics.gad7 / 21 * 100));
                const mbiScore = Math.max(0, 100 - (emp.metrics.mbi / 60 * 100));
                const sleepScore = Math.min(100, (emp.metrics.sleepDuration / 8) * 100);
                const balanceScore = (emp.metrics.workLifeBalance / 10) * 100;
                const stressScore = Math.max(0, 100 - (emp.metrics.stressLevel / 10 * 100));

                const empScore = (who5Score + phq9Score + gad7Score + mbiScore + sleepScore + balanceScore + stressScore) / 7;
                totalScore += empScore;
            });

            return Math.round(totalScore / employees.length);
        }

        // Calculate averages
        function calculateAverages() {
            const employees = teamData.employees;
            const sum = employees.reduce((acc, emp) => {
                Object.keys(emp.metrics).forEach(key => {
                    acc[key] = (acc[key] || 0) + emp.metrics[key];
                });
                return acc;
            }, {});

            const averages = {};
            Object.keys(sum).forEach(key => {
                averages[key] = sum[key] / employees.length;
            });

            return averages;
        }

        // Initialize analytics
        function initializeAnalytics() {
            const healthScore = calculateHealthScore();
            const averages = calculateAverages();

            // Health Score
            document.getElementById('healthScore').textContent = healthScore;
            setTimeout(() => {
                document.getElementById('healthProgress').style.width = healthScore + '%';
            }, 100);

            // Industry Benchmarks
            const industryAvg = { who5: 58, phq9: 8, gad7: 7, mbi: 30 };
            document.getElementById('who5Benchmark').textContent =
                averages.who5 >= industryAvg.who5 ? `‚Üë ${(averages.who5 - industryAvg.who5).toFixed(1)} –≤–∏—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ` : `‚Üì ${(industryAvg.who5 - averages.who5).toFixed(1)} –Ω–∏–∂—á–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ`;
            document.getElementById('phq9Benchmark').textContent =
                averages.phq9 <= industryAvg.phq9 ? `‚Üì ${(industryAvg.phq9 - averages.phq9).toFixed(1)} –∫—Ä–∞—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ` : `‚Üë ${(averages.phq9 - industryAvg.phq9).toFixed(1)} –≥—ñ—Ä—à–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ`;
            document.getElementById('gad7Benchmark').textContent =
                averages.gad7 <= industryAvg.gad7 ? `‚Üì ${(industryAvg.gad7 - averages.gad7).toFixed(1)} –∫—Ä–∞—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ` : `‚Üë ${(averages.gad7 - industryAvg.gad7).toFixed(1)} –≥—ñ—Ä—à–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ`;
            document.getElementById('mbiBenchmark').textContent =
                averages.mbi <= industryAvg.mbi ? `‚Üì ${(industryAvg.mbi - averages.mbi).toFixed(1)} –∫—Ä–∞—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ` : `‚Üë ${(averages.mbi - industryAvg.mbi).toFixed(1)} –≥—ñ—Ä—à–µ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ`;

            // Sleep Debt
            const idealSleep = 7.5;
            const sleepDebt = Math.max(0, (idealSleep - averages.sleepDuration) * 7);
            document.getElementById('sleepDebt').textContent = sleepDebt.toFixed(1);

            // Forecast
            generateForecast(averages);

            // Recommendations
            generateRecommendations(averages);

            // Charts
            initializeCharts();
        }

        // Generate forecast
        function generateForecast(averages) {
            const forecasts = [];

            if (averages.who5 < 60) {
                forecasts.push({
                    type: 'negative',
                    title: '–ü—Ä–æ–≥–Ω–æ–∑ –∑–Ω–∏–∂–µ–Ω–Ω—è –±–ª–∞–≥–æ–ø–æ–ª—É—á—á—è',
                    description: '–ü—Ä–∏ –ø–æ—Ç–æ—á–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫–∞—Ö WHO-5, –æ—á—ñ–∫—É—î—Ç—å—Å—è –ø–æ–¥–∞–ª—å—à–µ –∑–Ω–∏–∂–µ–Ω–Ω—è –Ω–∞ 5-8% –ø—Ä–æ—Ç—è–≥–æ–º –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö 2 –º—ñ—Å—è—Ü—ñ–≤ –±–µ–∑ –≤—Ç—Ä—É—á–∞–Ω–Ω—è.'
                });
            } else {
                forecasts.push({
                    type: 'positive',
                    title: '–°—Ç–∞–±—ñ–ª—å–Ω–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á—á—è',
                    description: '–ü–æ–∫–∞–∑–Ω–∏–∫–∏ WHO-5 –≤ –Ω–æ—Ä–º—ñ, –æ—á—ñ–∫—É—î—Ç—å—Å—è —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –ø–æ—Ç–æ—á–Ω–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫.'
                });
            }

            if (averages.sleepDuration < 7) {
                forecasts.push({
                    type: 'negative',
                    title: '–ù–∞–∫–æ–ø–∏—á–µ–Ω–Ω—è –¥–µ—Ñ—ñ—Ü–∏—Ç—É —Å–Ω—É',
                    description: '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—è —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Å–Ω—É –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –∑–Ω–∏–∂–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –Ω–∞ 15-20% —Ç–∞ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ä–∏–∑–∏–∫—É –≤–∏–≥–æ—Ä–∞–Ω–Ω—è.'
                });
            }

            if (averages.stressLevel > 6) {
                forecasts.push({
                    type: 'neutral',
                    title: '–ü—ñ–¥–≤–∏—â–µ–Ω–∏–π —Å—Ç—Ä–µ—Å –ø–æ—Ç—Ä–µ–±—É—î —É–≤–∞–≥–∏',
                    description: '–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º –∑–Ω–∏–∂–µ–Ω–Ω—è —Å—Ç—Ä–µ—Å—É –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø–æ–≥—ñ—Ä—à–µ–Ω–Ω—è –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤.'
                });
            } else {
                forecasts.push({
                    type: 'positive',
                    title: '–ö–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π —Ä—ñ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—É',
                    description: '–ü–æ—Ç–æ—á–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ —Å—Ç—Ä–µ—Å—É –≤ –ø—Ä–∏–π–Ω—è—Ç–Ω–∏—Ö –º–µ–∂–∞—Ö.'
                });
            }

            const forecastHTML = forecasts.map(f => `
                <div class="forecast-item ${f.type}">
                    <div class="forecast-title">${f.title}</div>
                    <div class="forecast-description">${f.description}</div>
                </div>
            `).join('');

            document.getElementById('forecastItems').innerHTML = forecastHTML;
        }

        // Generate recommendations
        function generateRecommendations(averages) {
            const recommendations = [];

            if (averages.sleepDuration < 7) {
                recommendations.push({
                    icon: 'üò¥',
                    title: '–ü—Ä–æ–≥—Ä–∞–º–∞ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ —Å–Ω—É',
                    content: '–í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –∑ –≥—ñ–≥—ñ—î–Ω–∏ —Å–Ω—É, —Ä–µ–∫–æ–º–µ–Ω–¥—É–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–∏ –¥–ª—è –º–µ–¥–∏—Ç–∞—Ü—ñ—ó —Ç–∞ —Ä–µ–ª–∞–∫—Å–∞—Ü—ñ—ó. –†–æ–∑–≥–ª—è–Ω—É—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≥–Ω—É—á–∫–æ–≥–æ –≥—Ä–∞—Ñ—ñ–∫—É –¥–ª—è —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –∑ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —Å–Ω—É.',
                    telegram: 'üò¥ –ü—Ä–æ–≥—Ä–∞–º–∞ —Å–Ω—É\n\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –∫–æ–º–∞–Ω–¥–∏:\n- –†–µ–≥—É–ª—è—Ä–Ω–∏–π —Ä–µ–∂–∏–º —Å–Ω—É\n- –û–±–º–µ–∂–µ–Ω–Ω—è –µ–∫—Ä–∞–Ω–Ω–æ–≥–æ —á–∞—Å—É –ø–µ—Ä–µ–¥ —Å–Ω–æ–º\n- –ú–µ–¥–∏—Ç–∞—Ü—ñ—è —Ç–∞ —Ä–µ–ª–∞–∫—Å–∞—Ü—ñ—è\n- –ì–Ω—É—á–∫–∏–π –≥—Ä–∞—Ñ—ñ–∫ –¥–ª—è –∫—Ä–∞—â–µ –∞–¥–∞–ø—Ç–∞—Ü—ñ—ó'
                });
            }

            if (averages.stressLevel > 6) {
                recommendations.push({
                    icon: 'üßò',
                    title: '–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç—Ä–µ—Å–æ–º',
                    content: '–û—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ —Ç—Ä–µ–Ω—ñ–Ω–≥–∏ –∑ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç—Ä–µ—Å–æ–º, –≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ —â–æ—Ç–∏–∂–Ω–µ–≤—ñ —Å–µ—Å—ñ—ó –π–æ–≥–∏ –∞–±–æ –º–µ–¥–∏—Ç–∞—Ü—ñ—ó, —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–æ–Ω—É —Ä–µ–ª–∞–∫—Å–∞—Ü—ñ—ó –≤ –æ—Ñ—ñ—Å—ñ.',
                    telegram: 'üßò –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç—Ä–µ—Å–æ–º\n\n–ü–ª–∞–Ω –¥—ñ–π:\n- –¢—Ä–µ–Ω—ñ–Ω–≥–∏ –∑ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç—Ä–µ—Å–æ–º\n- –©–æ—Ç–∏–∂–Ω–µ–≤—ñ —Å–µ—Å—ñ—ó –π–æ–≥–∏/–º–µ–¥–∏—Ç–∞—Ü—ñ—ó\n- –ó–æ–Ω–∞ —Ä–µ–ª–∞–∫—Å–∞—Ü—ñ—ó –≤ –æ—Ñ—ñ—Å—ñ\n- –†–µ–≥—É–ª—è—Ä–Ω—ñ –ø–µ—Ä–µ—Ä–≤–∏'
                });
            }

            if (averages.workLifeBalance < 6) {
                recommendations.push({
                    icon: '‚öñÔ∏è',
                    title: '–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è Work-Life –±–∞–ª–∞–Ω—Å—É',
                    content: '–í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫—É "–ø—Ä–∞–≤–æ –Ω–∞ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", –≥–Ω—É—á–∫–∏–π –≥—Ä–∞—Ñ—ñ–∫, –¥–Ω—ñ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ—ó —Ä–æ–±–æ—Ç–∏. –û—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ —Ç—ñ–º–±—ñ–ª–¥—ñ–Ω–≥–∏ —Ç–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ñ –∑–∞—Ö–æ–¥–∏.',
                    telegram: '‚öñÔ∏è Work-Life –±–∞–ª–∞–Ω—Å\n\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:\n- –ü—Ä–∞–≤–æ –Ω–∞ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—ñ—Å–ª—è —Ä–æ–±–æ—á–æ–≥–æ –¥–Ω—è\n- –ì–Ω—É—á–∫–∏–π –≥—Ä–∞—Ñ—ñ–∫ —Ä–æ–±–æ—Ç–∏\n- –î–Ω—ñ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ—ó —Ä–æ–±–æ—Ç–∏\n- –¢—ñ–º–±—ñ–ª–¥—ñ–Ω–≥–∏ —Ç–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–∏'
                });
            }

            const atRiskCount = teamData.employees.filter(emp =>
                emp.metrics.who5 < 50 || emp.metrics.phq9 > 10 || emp.metrics.gad7 > 10 || emp.metrics.mbi > 35
            ).length;

            if (atRiskCount > 0) {
                recommendations.push({
                    icon: 'üë®‚Äç‚öïÔ∏è',
                    title: '–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∞ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞',
                    content: `${atRiskCount} —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π –∑ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –æ—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ —Å–µ—Å—ñ—ó —Ç–∞ —Ä–æ–∑—Ä–æ–±–∏—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –ø–ª–∞–Ω–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.`,
                    telegram: `üë®‚Äç‚öïÔ∏è –ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞\n\n${atRiskCount} —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å —É–≤–∞–≥–∏:\n- –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—ó\n- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –ø–ª–∞–Ω–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏\n- –†–µ–≥—É–ª—è—Ä–Ω–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞–Ω—É\n- –ê–Ω–æ–Ω—ñ–º–Ω–∞ –≥–∞—Ä—è—á–∞ –ª—ñ–Ω—ñ—è`
                });
            }

            const recommendationsHTML = recommendations.map(r => `
                <div class="recommendation-card">
                    <div class="recommendation-header">
                        <div class="recommendation-icon">${r.icon}</div>
                        <div class="recommendation-title">${r.title}</div>
                    </div>
                    <div class="recommendation-content">${r.content}</div>
                    ${r.telegram ? `<button class="copy-btn" onclick="copyToClipboard(\`${r.telegram.replace(/`/g, '\\`')}\`)">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏ –¥–ª—è Telegram</button>` : ''}
                </div>
            `).join('');

            document.getElementById('recommendations').innerHTML = recommendationsHTML;
        }

        // Copy to clipboard
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É!');
            });
        }

        // Initialize charts
        function initializeCharts() {
            const averages = calculateAverages();

            // Sleep Chart
            const sleepCtx = document.getElementById('sleepChart').getContext('2d');
            new Chart(sleepCtx, {
                type: 'bar',
                data: {
                    labels: teamData.employees.map(e => e.name.split(' ')[0]),
                    datasets: [{
                        label: '–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Å–Ω—É (–≥–æ–¥)',
                        data: teamData.employees.map(e => e.metrics.sleepDuration),
                        backgroundColor: teamData.employees.map(e =>
                            e.metrics.sleepDuration >= 7 ? 'rgba(34, 197, 94, 0.5)' :
                            e.metrics.sleepDuration >= 6 ? 'rgba(251, 191, 36, 0.5)' :
                            'rgba(239, 68, 68, 0.5)'
                        ),
                        borderColor: teamData.employees.map(e =>
                            e.metrics.sleepDuration >= 7 ? '#22c55e' :
                            e.metrics.sleepDuration >= 6 ? '#fbbf24' :
                            '#ef4444'
                        ),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10,
                            grid: {
                                color: 'rgba(99, 102, 241, 0.1)'
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(99, 102, 241, 0.1)'
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Stress Distribution Chart
            const stressCtx = document.getElementById('stressChart').getContext('2d');
            const stressDistribution = {
                low: teamData.employees.filter(e => e.metrics.stressLevel <= 5).length,
                medium: teamData.employees.filter(e => e.metrics.stressLevel > 5 && e.metrics.stressLevel <= 7).length,
                high: teamData.employees.filter(e => e.metrics.stressLevel > 7).length
            };

            new Chart(stressCtx, {
                type: 'doughnut',
                data: {
                    labels: ['–ù–∏–∑—å–∫–∏–π (0-5)', '–°–µ—Ä–µ–¥–Ω—ñ–π (6-7)', '–í–∏—Å–æ–∫–∏–π (8-10)'],
                    datasets: [{
                        data: [stressDistribution.low, stressDistribution.medium, stressDistribution.high],
                        backgroundColor: [
                            'rgba(34, 197, 94, 0.5)',
                            'rgba(251, 191, 36, 0.5)',
                            'rgba(239, 68, 68, 0.5)'
                        ],
                        borderColor: [
                            '#22c55e',
                            '#fbbf24',
                            '#ef4444'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#cbd5e1',
                                padding: 15
                            }
                        }
                    }
                }
            });
        }

        // Initialize on load
        initializeAnalytics();
    </script>
</body>
</html>
