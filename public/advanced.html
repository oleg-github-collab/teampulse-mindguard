<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Analytics - TeamPulse Mindguard AI</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1 class="header-title">Advanced Analytics</h1>
            <nav class="header-nav">
                <a href="/dashboard.html" class="nav-btn">← Назад до Dashboard</a>
                <button class="logout-btn" onclick="handleLogout()">Вийти</button>
            </nav>
        </header>

        <!-- Momentum & Risks -->
        <section class="momentum-section">
            <div class="section-heading">
                <h2 class="section-title">Динаміка та ризики</h2>
                <p class="section-subtitle">Живі тренди команди, ранні тригери вигорання та опорні точки для 1:1</p>
            </div>
            <div class="momentum-grid">
                <div class="chart-card lift">
                    <div class="chart-title">Траєкторія благополуччя</div>
                    <canvas id="trajectoryChart"></canvas>
                    <p class="chart-note">WHO-5, стрес і сон нормовані до 100 для швидкого порівняння</p>
                    <div class="chart-actions">
                        <p class="chart-comment" id="trajectoryComment">Дані оновлюються...</p>
                        <button class="detail-btn" onclick="openChartModal('trajectoryModal')">Детальніше</button>
                    </div>
                </div>
                <div class="chart-card lift">
                    <div class="chart-title">Матриця ризиків 1:1</div>
                    <canvas id="riskBubbleChart"></canvas>
                    <div class="chart-note">Розмір кола = PHQ-9, X = стрес, Y = MBI. Колір = рівень ризику.</div>
                    <div class="chart-actions">
                        <p class="chart-comment" id="riskComment">Дані оновлюються...</p>
                        <button class="detail-btn" onclick="openChartModal('riskModal')">Детальніше</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Team Health Score -->
        <section class="health-score-section">
            <h2 class="section-title">Team Health Score</h2>
            <div class="health-score-card">
                <div class="health-score-value" id="healthScore">--</div>
                <div class="health-score-label">з 100</div>
                <div class="health-score-indicator" id="healthIndicator"></div>
            </div>
        </section>

        <!-- Industry Benchmarking -->
        <section class="benchmarking-section">
            <h2 class="section-title">Порівняння з індустрією</h2>
            <div class="benchmark-grid">
                <div class="benchmark-card">
                    <div class="benchmark-header">
                        <h3 title="WHO-5 Well-Being Index: 0-100, <50 — ризик зниження благополуччя, <28 — ймовірна депресія">WHO-5 Благополуччя</h3>
                        <span class="benchmark-status" id="who5Status"></span>
                    </div>
                    <div class="benchmark-comparison">
                        <div class="benchmark-bar">
                            <div class="benchmark-your" id="who5Your"></div>
                            <div class="benchmark-industry" id="who5Industry"></div>
                        </div>
                        <div class="benchmark-values">
                            <span>Ви: <strong id="who5YourValue">--</strong></span>
                            <span>Індустрія: <strong>62</strong></span>
                        </div>
                    </div>
                </div>

                <div class="benchmark-card">
                    <div class="benchmark-header">
                        <h3 title="PHQ-9: 0-27, >10 — середня депресивна симптоматика">PHQ-9 Депресія</h3>
                        <span class="benchmark-status" id="phq9Status"></span>
                    </div>
                    <div class="benchmark-comparison">
                        <div class="benchmark-bar">
                            <div class="benchmark-your" id="phq9Your"></div>
                            <div class="benchmark-industry" id="phq9Industry"></div>
                        </div>
                        <div class="benchmark-values">
                            <span>Ви: <strong id="phq9YourValue">--</strong></span>
                            <span>Індустрія: <strong>6.8</strong></span>
                        </div>
                    </div>
                </div>

                <div class="benchmark-card">
                    <div class="benchmark-header">
                        <h3 title="GAD-7: 0-21, >10 — середня/висока тривожність">GAD-7 Тривожність</h3>
                        <span class="benchmark-status" id="gad7Status"></span>
                    </div>
                    <div class="benchmark-comparison">
                        <div class="benchmark-bar">
                            <div class="benchmark-your" id="gad7Your"></div>
                            <div class="benchmark-industry" id="gad7Industry"></div>
                        </div>
                        <div class="benchmark-values">
                            <span>Ви: <strong id="gad7YourValue">--</strong></span>
                            <span>Індустрія: <strong>7.5</strong></span>
                        </div>
                    </div>
                </div>

                <div class="benchmark-card">
                    <div class="benchmark-header">
                        <h3 title="MBI: 0-100%, >40% — високий ризик вигорання">MBI Вигорання</h3>
                        <span class="benchmark-status" id="mbiStatus"></span>
                    </div>
                    <div class="benchmark-comparison">
                        <div class="benchmark-bar">
                            <div class="benchmark-your" id="mbiYour"></div>
                            <div class="benchmark-industry" id="mbiIndustry"></div>
                        </div>
                        <div class="benchmark-values">
                            <span>Ви: <strong id="mbiYourValue">--</strong></span>
                            <span>Індустрія: <strong>42</strong></span>
                        </div>
                    </div>
                </div>

                <div class="benchmark-card">
                    <div class="benchmark-header">
                        <h3 title="Суб'єктивний стрес: 0-40, >20 — підвищений рівень">Рівень стресу</h3>
                        <span class="benchmark-status" id="stressStatus"></span>
                    </div>
                    <div class="benchmark-comparison">
                        <div class="benchmark-bar">
                            <div class="benchmark-your" id="stressYour"></div>
                            <div class="benchmark-industry" id="stressIndustry"></div>
                        </div>
                        <div class="benchmark-values">
                            <span>Ви: <strong id="stressYourValue">--</strong></span>
                            <span>Індустрія: <strong>18</strong></span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Forecast -->
        <section class="forecast-section">
            <h2 class="section-title">Прогноз на наступний місяць</h2>
            <div class="forecast-warning">
                <p>⚠️ Прогноз базується на поточній динаміці без втручань</p>
            </div>
            <div class="forecast-grid" id="forecastGrid">
                <!-- Filled by JavaScript -->
            </div>
        </section>

        <!-- Sleep Debt Analysis -->
        <section class="sleep-debt-section">
            <h2 class="section-title">Аналіз боргу сну</h2>
            <div class="sleep-debt-summary">
                <div class="sleep-debt-stat">
                    <div class="stat-value" id="totalSleepDebt">--</div>
                    <div class="stat-label">Загальний борг сну команди (годин)</div>
                </div>
                <div class="sleep-debt-stat">
                    <div class="stat-value" id="avgSleepDebt">--</div>
                    <div class="stat-label">Середній борг на людину (год/тиждень)</div>
                </div>
                <div class="sleep-debt-stat">
                    <div class="stat-value" id="atRiskCount">--</div>
                    <div class="stat-label">Кількість людей в зоні ризику</div>
                </div>
            </div>
            <div class="sleep-debt-chart">
                <canvas id="sleepDebtChart"></canvas>
            </div>
            <div class="sleep-debt-citation">
                <p><strong>Дослідження Stanford/McKinsey:</strong> Працівники з недостатнім сном мають 70% вищий ризик вигорання та на 45% нижчу продуктивність.</p>
            </div>
        </section>

        <!-- Deep Employee Insights -->
        <section class="insights-section">
            <div class="section-heading">
                <h2 class="section-title">Ключові інсайти по людям</h2>
                <p class="section-subtitle">Топ-ризики, відновлення та еталонні практики, які варто масштабувати</p>
            </div>
            <div class="insight-grid" id="insightGrid">
                <!-- Filled by JavaScript -->
            </div>
        </section>

        <!-- ROI Calculator -->
        <section class="roi-section">
            <h2 class="section-title">ROI Calculator - Потенційна економія</h2>
            <div class="roi-grid">
                <div class="roi-card">
                    <div class="roi-label">Покращення сну</div>
                    <div class="roi-value" id="roiSleep">+1.2 год/день</div>
                </div>
                <div class="roi-card">
                    <div class="roi-label">Зростання продуктивності</div>
                    <div class="roi-value" id="roiProductivity">+18%</div>
                </div>
                <div class="roi-card">
                    <div class="roi-label">Зниження вигорання</div>
                    <div class="roi-value" id="roiBurnout">-35%</div>
                </div>
                <div class="roi-card roi-highlight">
                    <div class="roi-label">Річна економія компанії</div>
                    <div class="roi-value" id="roiSavings">$21,500</div>
                </div>
            </div>
        </section>

        <!-- Personalized Recommendations -->
        <section class="recommendations-section">
            <div class="section-heading">
                <h2 class="section-title">1:1 плейбуки та чіткі наступні кроки</h2>
                <p class="section-subtitle">Структуровані сценарії дзвінків, мікродії на 7 днів і контрольні питання з світових практик коучингу</p>
            </div>
            <div class="recommendations-grid" id="recommendationsGrid">
                <!-- Filled by JavaScript -->
            </div>
        </section>

        <!-- Chart Detail Modals -->
        <div id="trajectoryModal" class="modal" onclick="modalBgClick(event, 'trajectoryModal')">
            <div class="modal-content">
                <span class="modal-close" onclick="closeChartModal('trajectoryModal')">&times;</span>
                <h2 class="modal-title">Траєкторія благополуччя</h2>
                <div class="modal-notes">
                    <p id="trajectorySummary">Дані оновлюються...</p>
                </div>
                <div class="modal-metrics">
                    <h3>Ключові показники</h3>
                    <div class="modal-metrics-grid" id="trajectoryMetrics"></div>
                </div>
            </div>
        </div>

        <div id="riskModal" class="modal" onclick="modalBgClick(event, 'riskModal')">
            <div class="modal-content">
                <span class="modal-close" onclick="closeChartModal('riskModal')">&times;</span>
                <h2 class="modal-title">Матриця ризиків 1:1</h2>
                <div class="modal-notes">
                    <p id="riskSummary">Дані оновлюються...</p>
                </div>
                <div class="modal-metrics">
                    <h3>Розкладання ризику</h3>
                    <div class="modal-metrics-grid" id="riskMetrics"></div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p>&copy; 2025 TeamPulse Mindguard AI. Всі права захищені.</p>
        </footer>
    </div>

    <script src="/js/advanced.js"></script>
</body>
</html>
